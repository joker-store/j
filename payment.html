<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A7med_Ashraf</title>
<style>
body {
  font-family: Tahoma, sans-serif;
  direction: rtl;
  text-align: center;
  margin: 0; padding: 0;
  min-height: 100vh;
  background: url('YOUR_BACKGROUND.jpg') center/cover no-repeat;
}
.container {
  width: 95%;
  max-width: 500px;
  margin: 20px auto;
  background: rgba(255,255,255,0.1);
  padding: 20px;
  border-radius: 15px;
  color: #fff;
}
.payment-buttons {
  display: flex;
  justify-content: space-around;
  margin-bottom: 20px;
}
.payment-buttons button {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 120px;
  height: 120px;
  border: 2px solid white;
  border-radius: 15px;
  cursor: pointer;
  font-size: 14px;
  background: rgba(255,255,255,0.1);
  transition: 0.2s;
  color: white;
}
.payment-buttons button:hover { transform: scale(1.05); background: rgba(255,255,255,0.2); }
.payment-buttons img { width: 50px; height: 50px; margin-bottom: 10px; }

input, button.send-btn { width: 90%; padding: 10px; margin: 10px 0; border-radius: 10px; border: none; font-size: 1em; }
button.send-btn { background-color: #28a745; color: white; cursor: pointer; }
button.send-btn:hover { background-color: #218838; }

.payment-card { background: rgba(0,0,0,0.5); margin: 10px 0; padding: 10px; border-radius: 10px; }
.payment-card img { max-width: 100%; margin: 10px 0; }
button.confirm { background: #28a745; color: #fff; margin-right: 5px; }
button.delete { background: #dc3545; color: #fff; }

#paymentForm { display: none; }
#adminPanel { display: none; margin-top:20px; }

/* ✅ أيقونة الأدمن */
#adminIcon {
  position: fixed;
  top: 20px;
  left: 20px;
  cursor: pointer;
  width: 50px;
  height: 50px;
  border-radius: 50%;
}

#passwordModal { 
  display:none; 
  position:fixed; 
  top:0; left:0; 
  width:100%; height:100%; 
  background:rgba(0,0,0,0.7); 
  justify-content:center; 
  align-items:center; 
}
#passwordModalContent { 
  background:#fff; 
  padding:20px; 
  border-radius:10px; 
  width:300px; 
  text-align:center; 
  color:#000; 
}
</style>
</head>
<body>

<!-- ✅ أيقونة الأدمن -->
<img id="adminIcon" src="admin_icon.png" alt="أيقونة الأدمن" title="لوحة الأدمن">

<div class="container">
  <h2>طرق الدفع</h2>
  <h2>سيتم التحقق من الدفع وخصم المبلغ بعد ساعة بحد اقصى</h2>
  <div class="payment-buttons">
    <button onclick="openPayment('فودافون كاش')">
      <img src="fcash_icon.png" alt="فودافون كاش">فودافون كاش
    </button>
    <button onclick="openPayment('Instapay')">
      <img src="instapay_icon.png" alt="Instapay">Instapay
    </button>
  </div>

  <!-- نموذج الدفع -->
  <div id="paymentForm">
    <h3>إرسال التحويل: <span id="selectedMethod"></span></h3>
    <h3>Instapay:01055900315</h3>
    <h3>VF_Cash:01019728653</h3>
     <input type="text" id="name" placeholder="اسم المحول">
    <input type="text" id="senderPhone" placeholder="رقم الهاتف المحول منه">
    <input type="number" id="amount" placeholder="المبلغ المحول">
    <input type="file" id="transferImage" accept="image/*">
    <button class="send-btn" onclick="submitPayment()">إرسال</button>
    <p id="loadingMsg"></p>
  </div>

  <!-- لوحة الأدمن -->
  <div id="adminPanel">
    <h2>طلبات الأدمن</h2>
    <div id="paymentsContainer"><p>جارٍ تحميل الطلبات...</p></div>
  </div>
</div>

<!-- نافذة الباسورد -->
<div id="passwordModal">
  <div id="passwordModalContent">
    <h3>أدخل كلمة المرور</h3>
    <input type="password" id="adminPassword" placeholder="كلمة المرور">
    <br>
    <button onclick="checkPassword()">دخول</button>
    <button onclick="closePasswordModal()">إلغاء</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// Firebase
const firebaseConfig = {
  apiKey: "AIzaSyDZQJZnekkDRf6jGIplVFlx0MckFR-xed8",
  authDomain: "ahmed-77878.firebaseapp.com",
  databaseURL: "https://ahmed-77878-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "ahmed-77878",
  storageBucket: "ahmed-77878.appspot.com",
  messagingSenderId: "566732207368",
  appId: "1:566732207368:web:d88477f62ecf475e2628bd"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// الدفع
let selectedMethod = "";
function openPayment(method){
  selectedMethod = method;
  document.getElementById('selectedMethod').innerText = method;
  document.getElementById('paymentForm').style.display='block';
}

function submitPayment(){
  const name = document.getElementById('name').value.trim();
  const senderPhone = document.getElementById('senderPhone').value.trim();
  const amount = parseFloat(document.getElementById('amount').value);
  const imageFile = document.getElementById('transferImage').files[0];

  if(!selectedMethod){
    alert("اختر طريقة الدفع أولاً");
    return;
  }

  if(!name || !senderPhone || !amount){
    alert("ادخل جميع البيانات المطلوبة!");
    return;
  }

  if(imageFile){
    const reader = new FileReader();
    reader.onload = function(e){
      sendPaymentToDB(name, senderPhone, amount, e.target.result);
    };
    reader.readAsDataURL(imageFile);
  } else {
    sendPaymentToDB(name, senderPhone, amount, null);
  }
}

function sendPaymentToDB(name, senderPhone, amount, base64Image){
  const paymentRef = db.ref('payments').push();
  paymentRef.set({
    method: selectedMethod,
    name,
    senderPhone,
    amount,
    date: new Date().toLocaleString(),
    confirmed:false,
    imageBase64: base64Image
  });

  document.getElementById('loadingMsg').innerText="تم الإرسال!";
  setTimeout(()=>{
    document.getElementById('paymentForm').style.display='none';
    document.getElementById('loadingMsg').innerText="";
    document.getElementById('name').value="";
    document.getElementById('senderPhone').value="";
    document.getElementById('amount').value="";
    document.getElementById('transferImage').value="";
    document.getElementById('selectedMethod').innerText="";
    selectedMethod = "";
  },500);
}

// أيقونة الأدمن
const adminIcon = document.getElementById('adminIcon');
const passwordModal = document.getElementById('passwordModal');
adminIcon.onclick = ()=>{ passwordModal.style.display='flex'; }
function closePasswordModal(){ passwordModal.style.display='none'; document.getElementById('adminPassword').value=''; }

function checkPassword(){
  const pass = document.getElementById('adminPassword').value;
  if(pass==='joker2020'){ // الباسورد
    passwordModal.style.display='none';
    document.getElementById('adminPanel').style.display='block';
    loadAdminPayments();
  } else { alert("كلمة المرور غير صحيحة!"); }
}

// لوحة الأدمن
function loadAdminPayments(){
  const container = document.getElementById('paymentsContainer');
  db.ref('payments').on('value', snapshot=>{
    container.innerHTML="";
    if(!snapshot.exists()){ container.innerHTML="<p>لا يوجد طلبات حالياً</p>"; return; }
    snapshot.forEach(child=>{
      const p = child.val();
      const card = document.createElement('div');
      card.className='payment-card';
      card.innerHTML=`
        <p><strong>طريقة الدفع:</strong> ${p.method}</p>
        <p><strong>اسم المحول:</strong> ${p.name}</p>
        <p><strong>رقم الهاتف:</strong> ${p.senderPhone}</p>
        <p><strong>المبلغ:</strong> ${p.amount} جنيه</p>
        ${p.imageBase64? `<img src="${p.imageBase64}" alt="صورة التحويل">` : ''}
        <button class="confirm" onclick="confirmPayment('${child.key}')">تأكيد</button>
        <button class="delete" onclick="deletePayment('${child.key}')">حذف</button>
      `;
      container.appendChild(card);
    });
  });
}

function confirmPayment(id){ db.ref(`payments/${id}`).update({confirmed:true}); }
function deletePayment(id){ db.ref(`payments/${id}`).remove(); }
</script>
</body>
</html>
