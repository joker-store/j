<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة الأدمن</title>
<style>
body { font-family: Tahoma, sans-serif; direction: rtl; text-align: center; background: #f0f0f0; }
.container { width: 95%; max-width: 600px; margin: 20px auto; }
.payment-card { background: #fff; padding: 15px; margin: 10px 0; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); }
.payment-card img { max-width: 100%; margin: 10px 0; }
button { margin: 5px; padding: 5px 10px; border: none; border-radius: 5px; cursor: pointer; }
.confirm { background: #28a745; color: #fff; }
.delete { background: #dc3545; color: #fff; }
</style>
</head>
<body>
<h2>طلبات التحويل الجديدة</h2>
<div class="container" id="paymentsContainer">
  <p>جارٍ تحميل الطلبات...</p>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDZQJZnekkDRf6jGIplVFlx0MckFR-xed8",
  authDomain: "ahmed-77878.firebaseapp.com",
  databaseURL: "https://ahmed-77878-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "ahmed-77878",
  storageBucket: "ahmed-77878.appspot.com",
  messagingSenderId: "566732207368",
  appId: "1:566732207368:web:d88477f62ecf475e2628bd"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const container = document.getElementById('paymentsContainer');
container.innerHTML = '';

db.ref('payments').on('value', snapshot => {
  container.innerHTML = '';
  if(!snapshot.exists()) {
    container.innerHTML = "<p>لا يوجد طلبات حالياً</p>";
    return;
  }
  snapshot.forEach(child => {
    const p = child.val();
    const card = document.createElement('div');
    card.className = 'payment-card';
    card.innerHTML = `
      <p><strong>طريقة الدفع:</strong> ${p.method}</p>
      <p><strong>رقم الهاتف:</strong> ${p.senderPhone}</p>
      <p><strong>المبلغ:</strong> ${p.amount} جنيه</p>
      ${p.imageBase64 ? `<img src="${p.imageBase64}" alt="صورة التحويل">` : ''}
      <button class="confirm" onclick="confirmPayment('${child.key}')">تأكيد</button>
      <button class="delete" onclick="deletePayment('${child.key}')">حذف</button>
    `;
    container.appendChild(card);
  });
});

function confirmPayment(id) {
  db.ref(`payments/${id}`).update({ confirmed: true });
}

function deletePayment(id) {
  db.ref(`payments/${id}`).remove();
}
</script>
</body>
</html>
